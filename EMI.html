<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EMI Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    .calculator-card {
      background-color: #fff;
      border-radius: 20px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    .input-group label {
      font-weight: 600;
      color: #4b5563;
    }
    .input-field input[type="number"] {
      width: 100%;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      font-weight: 500;
      color: #1f2937;
      text-align: right;
      padding: 0.5rem 2.5rem 0.5rem 2rem;
    }
    .input-field .currency-symbol,
    .input-field .unit {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: #9ca3af;
      font-size: 0.9rem;
    }
    .input-field .currency-symbol {
      left: 0.75rem;
    }
    .input-field .unit {
      right: 0.75rem;
    }
    .results-container {
      background-color: #e0f2f1;
      border-radius: 1rem;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    .results-container .result-item {
      display: flex;
      justify-content: space-between;
      font-size: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px dashed #b2dfdb;
    }
    .results-container .result-item:last-child {
      border-bottom: none;
    }
    .result-value {
      font-weight: 700;
      color: #00897b;
      font-size: 1.125rem;
    }
    .chart-container {
      background-color: #f7fafc;
      border-radius: 1rem;
      padding: 1rem;
      height: 260px;
    }
    @media (min-width: 768px) {
      .chart-container {
        height: 300px;
      }
    }
    .range-slider {
      -webkit-appearance: none;
      width: 100%;
      height: 8px;
      background: #d1d5db;
      border-radius: 5px;
      outline: none;
    }
    .range-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: #00897b;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid #fff;
    }
  </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

<main class="w-full max-w-2xl">
  <header class="text-center mb-6">
    <h1 class="text-2xl md:text-3xl font-bold text-gray-800">EMI Calculator</h1>
    <p class="text-base md:text-lg text-gray-600 mt-2">Calculate your fixed monthly loan repayment installment.</p>
  </header>

  <div class="calculator-card">
    <div class="flex flex-col lg:flex-row gap-8">

      <!-- Inputs -->
      <div class="flex-1 flex flex-col">
        <div class="input-group">
          <label for="loan-amount-input">Principal Loan Amount (₹)</label>
          <div class="input-field relative">
            <span class="currency-symbol">₹</span>
            <input type="number" id="loan-amount-input" value="1000000" />
          </div>
        </div>
        <input type="range" id="loan-amount-range" min="100000" max="50000000" step="50000" value="1000000" class="range-slider mt-2" oninput="syncInputs('loan-amount')" />

        <div class="input-group mt-6">
          <label for="interest-rate-input">Annual Interest Rate (p.a. %)</label>
          <div class="input-field relative">
            <input type="number" id="interest-rate-input" value="9" />
            <span class="unit">%</span>
          </div>
        </div>
        <input type="range" id="interest-rate-range" min="1" max="25" step="0.1" value="9" class="range-slider mt-2" oninput="syncInputs('interest-rate')" />

        <div class="input-group mt-6">
          <label for="tenure-input">Loan Tenure (Years)</label>
          <div class="input-field relative">
            <input type="number" id="tenure-input" value="15" />
          </div>
        </div>
        <input type="range" id="tenure-range" min="1" max="30" step="1" value="15" class="range-slider mt-2" oninput="syncInputs('tenure')" />
      </div>

      <!-- Chart + Results -->
      <div class="flex-1 flex flex-col gap-6 mt-6 lg:mt-0">
        <div class="chart-container">
          <canvas id="emi-chart"></canvas>
        </div>

        <div class="results-container">
          <div class="result-item">
            <span>Monthly EMI:</span>
            <span id="emi-amount" class="text-red-600 font-extrabold text-xl">₹ 0</span>
          </div>
          <div class="result-item">
            <span>Total Interest:</span>
            <span id="total-interest" class="text-teal-700 font-bold">₹ 0</span>
          </div>
          <div class="result-item">
            <span>Total Repayment:</span>
            <span id="total-repayment" class="text-teal-700 font-bold text-xl">₹ 0</span>
          </div>
        </div>
      </div>

    </div>
  </div>
</main>

<script>
  let emiChart;
  const nbsp = "\u00A0";

  const calculate = () => {
    const loanAmount = parseFloat(document.getElementById("loan-amount-input").value) || 0;
    const interestRate = parseFloat(document.getElementById("interest-rate-input").value) / 100 || 0;
    const tenure = parseFloat(document.getElementById("tenure-input").value) || 0;

    const totalMonths = tenure * 12;
    const monthlyRate = interestRate / 12;

    if (loanAmount <= 0 || totalMonths <= 0) {
      document.getElementById("emi-amount").innerText = "₹ 0";
      document.getElementById("total-interest").innerText = "₹ 0";
      document.getElementById("total-repayment").innerText = "₹ 0";
      updateChart(0, 0);
      return;
    }

    let emi;
    if (monthlyRate === 0) {
      emi = loanAmount / totalMonths;
    } else {
      const factor = Math.pow(1 + monthlyRate, totalMonths);
      emi = loanAmount * monthlyRate * factor / (factor - 1);
    }

    const totalRepayment = emi * totalMonths;
    const totalInterest = totalRepayment - loanAmount;

    document.getElementById("emi-amount").innerText = `₹${nbsp}${Math.round(emi).toLocaleString("en-IN")}`;
    document.getElementById("total-interest").innerText = `₹${nbsp}${Math.round(totalInterest).toLocaleString("en-IN")}`;
    document.getElementById("total-repayment").innerText = `₹${nbsp}${Math.round(totalRepayment).toLocaleString("en-IN")}`;

    updateChart(loanAmount, totalInterest);
  };

  const updateChart = (principal, interest) => {
    const ctx = document.getElementById("emi-chart").getContext("2d");
    if (emiChart) emiChart.destroy();

    emiChart = new Chart(ctx, {
      type: "pie",
      data: {
        labels: ["Principal", "Interest"],
        datasets: [{
          data: [principal, interest],
          backgroundColor: ["#00897b", "#f44336"],
          hoverOffset: 10,
        }],
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: "bottom" },
          title: {
            display: true,
            text: "Total Repayment Breakdown",
            font: { size: 18, weight: "bold" },
            color: "#00897b",
          },
        },
      },
    });
  };

  const syncInputs = (id) => {
    document.getElementById(`${id}-input`).value = document.getElementById(`${id}-range`).value;
    calculate();
  };

  document.querySelectorAll("input").forEach(input => input.addEventListener("input", calculate));
  calculate();
</script>

</body>
</html>
